(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17850,        445]
NotebookOptionsPosition[     17453,        426]
NotebookOutlinePosition[     17831,        443]
CellTagsIndexPosition[     17788,        440]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", " ", 
   RowBox[{
   "*", " ", "Transform", " ", "3", "D", " ", "object", " ", "to", " ", "4", 
    "D"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"object3", ",", "object4"}], "]"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"object3", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Polygon", "@", "object3"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"object4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"object3", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"object3", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"object3", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "object3", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7513973453932543`*^9, 3.751397682588915*^9}, {
  3.751397726360508*^9, 3.7513979465919867`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", " ", 
   RowBox[{
   "*", " ", "Transform", " ", "4", "D", " ", "object", " ", "to", " ", "3", 
    "D"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"unfold4", ",", "object3Unfolded"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"unfold4", "[", "facet4_", "]"}], ":=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "origin4", ",", "unfold3", ",", "facet4Linear", ",", "b1", ",", "b2", 
         ",", "b3", ",", "b3m", ",", "basis4Proto", ",", 
         "\[IndentingNewLine]", "i", ",", "j", ",", "count", ",", "contained",
          ",", "done"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
         "*", " ", "Compute", " ", "the", " ", "3", "D", " ", "hyperplane", 
          " ", "this", " ", "facet", " ", "lies", " ", "on"}], ",", " ", 
         RowBox[{"and", " ", "embed", " ", "in", " ", "R3"}]}], 
        "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"choose", " ", "arbitrary", " ", "origin"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"origin4", "=", 
         RowBox[{
          RowBox[{"facet4", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"translate", " ", "to", " ", "origin"}], ",", " ", 
          RowBox[{"to", " ", "make", " ", "linear"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"facet4Linear", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"facet4", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "-", "origin4"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"facet4", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "facet4", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "choose", " ", "three", " ", "arbitrary", " ", "vector4s", " ", 
          "that", " ", "span", " ", "facet4"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"j", ":=", "2"}], ";", 
        RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis4Proto", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "facet4", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "[", 
               RowBox[{"facet4", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{
                RowBox[{"facet4", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"contained", "=", 
               RowBox[{"ContainsAny", "[", 
                RowBox[{"basis4Proto", ",", 
                 RowBox[{"{", "v", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"done", "=", 
               RowBox[{"count", "\[GreaterEqual]", "3"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"!", "contained"}], "\[And]", 
                 RowBox[{"!", "done"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"basis4Proto", ",", "v"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"count", "=", 
                  RowBox[{"count", "+", "1"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"j", "++"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"i", "++"}], ";", 
           RowBox[{"j", "=", "2"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "orthoganolize", " ", "vectors", " ", "to", " ", "make", " ", 
           "basis4"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}], "=", 
         RowBox[{"Orthogonalize", "[", "basis4Proto", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "takes", " ", "a", " ", "facet3", " ", "in", " ", "R4", " ", "and", 
          " ", "convert", " ", "all", " ", "of", " ", "its", " ", "vertices", 
          " ", "to", " ", "R3", " ", "in", " ", "terms", " ", "of", " ", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"unfold3", "[", "v_", "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "vp"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vp", "=", 
             RowBox[{"N", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"m", "=", 
             RowBox[{"RowReduce", "[", 
              RowBox[{"(", GridBox[{
                 {
                  RowBox[{"b1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], 
                  RowBox[{"b2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], 
                  RowBox[{"b3", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], 
                  RowBox[{"vp", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]},
                 {
                  RowBox[{"b1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], 
                  RowBox[{"b2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], 
                  RowBox[{"b3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], 
                  RowBox[{"vp", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]},
                 {
                  RowBox[{"b1", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], 
                  RowBox[{"b2", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], 
                  RowBox[{"b3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], 
                  RowBox[{"vp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]},
                 {
                  RowBox[{"b1", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], 
                  RowBox[{"b2", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], 
                  RowBox[{"b3", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], 
                  RowBox[{"vp", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}
                }], ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"unfold3", "[", 
              RowBox[{
               RowBox[{"facet4", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"facet4", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "facet4", "]"}]}], "}"}]}], "]"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"Row", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"Polygon", "@", "object3"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
        ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\"\<\[Rule]\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"Polygon", "@", 
         RowBox[{"unfold4", "[", "object4", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
        ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.751397287763875*^9, 3.751397294570816*^9}, {
  3.751397335552702*^9, 3.751397362823227*^9}, {3.751397692850404*^9, 
  3.7513977043603287`*^9}, {3.751397950521783*^9, 3.7513980362355127`*^9}, {
  3.7513980922541*^9, 3.751398115732373*^9}, {3.751398152440687*^9, 
  3.751398166095916*^9}}],

Cell[BoxData[
 TemplateBox[{Graphics3DBox[
    Polygon3DBox[{{{0, 0, 0}, {1, 0, 0}, {0, 1, 0}}, {{0, 0, 0}, {0, 1, 0}, {
     0, 0, 1}}, {{0, 0, 0}, {1, 0, 0}, {0, 0, 1}}, {{0, 0, 1}, {1, 0, 0}, {0, 
     1, 0}}}], AspectRatio -> 1, Axes -> True, AxesLabel -> {
      FormBox["\"x\"", TraditionalForm], 
      FormBox["\"y\"", TraditionalForm], 
      FormBox["\"z\"", TraditionalForm]}, 
    ImageSize -> {307.79947916666663`, Automatic}, 
    ViewPoint -> {-0.5171751748321102, -2.4273486361972263`, 
     2.3001105271027393`}, 
    ViewVertical -> {-0.23502135219780712`, 0.13785872931704235`, 
     0.9621641932446898}],"\"\[Rule]\"",Graphics3DBox[
    Polygon3DBox[{{{0., 0., 0.}, {1.4142135623730951`, 0., 0.}, {
     0.7071067811865476, 1.224744871391589, -1.2819751242557092`*^-16}}, {{0.,
      0., 0.}, {0.7071067811865476, 
     1.224744871391589, -1.2819751242557092`*^-16}, {0.7071067811865476, 
     0.40824829046386296`, 1.1547005383792512`}}, {{0., 0., 0.}, {
     1.4142135623730951`, 0., 0.}, {0.7071067811865476, 0.40824829046386296`, 
     1.1547005383792512`}}, {{0.7071067811865476, 0.40824829046386296`, 
     1.1547005383792512`}, {1.4142135623730951`, 0., 0.}, {0.7071067811865476,
      1.224744871391589, -1.2819751242557092`*^-16}}}], AspectRatio -> 1, 
    Axes -> True, AxesLabel -> {
      FormBox["\"x\"", TraditionalForm], 
      FormBox["\"y\"", TraditionalForm], 
      FormBox["\"z\"", TraditionalForm]}, 
    ImageSize -> {315.48177083333314`, Automatic}, 
    ViewPoint -> {2.175323211049474, -0.9202504027912671, 
     2.4230369629107837`}, 
    ViewVertical -> {0.03067904758295409, 0.4124505473643904, 
     1.1433321076070906`}]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.75139795558109*^9, 3.751397968097307*^9}, {
   3.7513980076071377`*^9, 3.751398036806678*^9}, 3.751398116319808*^9, 
   3.751398166556335*^9}]
}, Open  ]]
},
WindowSize->{1280, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3834, 104, 824, "Input"],
Cell[CellGroupData[{
Cell[4417, 128, 11152, 259, 2104, "Input"],
Cell[15572, 389, 1865, 34, 540, "Output"]
}, Open  ]]
}
]
*)

